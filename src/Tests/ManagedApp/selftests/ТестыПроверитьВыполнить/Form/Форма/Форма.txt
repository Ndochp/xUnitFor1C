&НаКлиенте
Перем Я_Тест;

&НаКлиенте
Функция ПолучитьСписокТестов(юТест) Экспорт
	
	Я_Тест = юТест;
	
	Результат = Я_Тест.Новый_НаборТестов();
	
	Я_Тест.НаборТестов_Добавить(Результат, "Тесты_ПроверитьВыполнилось");
	Я_Тест.НаборТестов_Добавить(Результат, "Тесты_ПроверитьВыполнилосьУпал");
	
	Я_Тест.НаборТестов_Добавить(Результат, "Тест_ПроверитьНеВыполнилось");
	Я_Тест.НаборТестов_Добавить(Результат, "Тест_ПроверитьНеВыполнилосьУпал");
	
	Я_Тест.НаборТестов_Добавить(Результат, "Тесты_ПроверитьМетодВыполнился");
	Я_Тест.НаборТестов_Добавить(Результат, "Тесты_ПроверитьМетодВыполнилсяУпал");
	
	Я_Тест.НаборТестов_Добавить(Результат, "Тесты_ПроверитьМетодНеВыполнился");
	Я_Тест.НаборТестов_Добавить(Результат, "Тесты_ПроверитьМетодНеВыполнилсяУпал");
	
	Я_Тест.НаборТестов_Добавить(Результат, "Bug_4456");
	
	Возврат Результат;
	
КонецФункции

&НаКлиенте
Процедура Тесты_ПроверитьВыполнилось() Экспорт
	Я_Тест.ПроверитьВыполнилось("рез = 10");
КонецПроцедуры

&НаКлиенте
Процедура Тесты_ПроверитьВыполнилосьУпал() Экспорт
	Я_Тест.ПроверитьНеВыполнилось("ПроверитьВыполнилось(""рез = 1/0"")", "Хотели, чтобы алгоритм ""рез = 1/0"" выполнился, а он упал с ошибкой ""{(1)}: Деление на 0");
КонецПроцедуры

&НаКлиенте
Процедура Тест_ПроверитьНеВыполнилось() Экспорт
	Я_Тест.ПроверитьНеВыполнилось("рез = 1/0", "Деление на 0");
КонецПроцедуры

&НаКлиенте
Процедура Тест_ПроверитьНеВыполнилосьУпал() Экспорт
	Я_Тест.ПроверитьНеВыполнилось("ПроверитьНеВыполнилось(""рез = 10"", ""Деление на 0"")", "Хотели, чтобы алгоритм ""рез = 10"" упал, а он выполнился");
	Я_Тест.ПроверитьНеВыполнилось("ПроверитьНеВыполнилось(""рез = 1/0"", ""Другое сообщение об ошибке"")", "Хотели, чтобы алгоритм ""рез = 1/0"" упал с сообщением об ошибке ""Другое сообщение об ошибке"", а он упал с сообщением ""{(1)}: Деление на 0");
КонецПроцедуры

&НаКлиенте
Процедура Тесты_ПроверитьМетодВыполнился() Экспорт
	Текст = Новый ТекстовыйДокумент;
	Я_Тест.ПроверитьМетодВыполнился(Текст, "Очистить");
КонецПроцедуры

&НаКлиенте
Процедура Тесты_ПроверитьМетодВыполнилсяУпал() Экспорт
	Я_Тест.ПроверитьНеВыполнилось("Текст = Новый ТекстовыйДокумент; ПроверитьМетодВыполнился(Текст, ""__Очистить"")", "Хотели, чтобы код ""Объект.__Очистить()"" выполнился, а он упал с ошибкой ""{(1)}: Метод объекта не обнаружен (__Очистить)");
КонецПроцедуры

&НаКлиенте
Процедура Тесты_ПроверитьМетодНеВыполнился() Экспорт
	Текст = Новый ТекстовыйДокумент;
	Я_Тест.ПроверитьМетодНеВыполнился(Текст, "__Очистить", "Метод объекта не обнаружен (__Очистить)");
КонецПроцедуры

&НаКлиенте
Процедура Тесты_ПроверитьМетодНеВыполнилсяУпал() Экспорт
	Я_Тест.ПроверитьНеВыполнилось("Текст = Новый ТекстовыйДокумент;ПроверитьМетодНеВыполнился(Текст, ""Очистить"", ""Тут неважно, что"")", "Хотели, чтобы код ""Объект.Очистить()"" упал, а он выполнился");
	Я_Тест.ПроверитьНеВыполнилось("Текст = Новый ТекстовыйДокумент;ПроверитьМетодНеВыполнился(Текст, ""__Очистить"", ""Тут неважно, что"")", "Хотели, чтобы код ""Объект.__Очистить()"" упал с сообщением об ошибке ""Тут неважно, что"", а он упал с сообщением ""{(1)}: Метод объекта не обнаружен (__Очистить)");
КонецПроцедуры

&НаКлиенте
Процедура Bug_4456() Экспорт
	Я_Тест.ПроверитьВыполнилось("Упало = Истина");
	Я_Тест.ПроверитьВыполнилось("Успех = Ложь");
КонецПроцедуры